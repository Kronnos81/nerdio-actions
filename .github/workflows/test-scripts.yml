name: Test AVD image scripts

on:
  workflow_dispatch:
  schedule:
    - cron: '0 1 15 * *' #Run on the 15th of each month
    
permissions:
  contents: read

jobs:
  build:
    permissions:
      contents: read # for actions/checkout to fetch code

    name: Test
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v3

      - name: Run scripts
        shell: powershell
        working-directory: "${{ github.workspace }}\\avd"
        run: |
          .\00_Rds-PrepImage.ps1
          .\01_SupportFunctions.ps1
          #.\02_WindowsUpdate.ps1
          #.\03_RegionLanguage.ps1
          .\04_Rds-Roles.ps1
          .\05_Customise.ps1
          .\06_MicrosoftVcRedists.ps1
          .\07_MicrosoftNET.ps1
          .\08_MicrosoftFSLogixApps.ps1
          .\09_MicrosoftEdge.ps1
          .\10_Microsoft365Apps.ps1
          .\11_MicrosoftTeams.ps1
          .\12_MicrosoftOneDrive.ps1
          .\14_Wvd-Agents.ps1
          .\39_AdobeAcrobatReaderDC.ps1
          .\98_FinaliseImage.ps1
